{"mappings":"C,A,S,C,C,C,C,C,C,C,C,C,E,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,A,Y,O,C,C,E,E,C,C,E,C,E,E,K,E,C,E,E,A,a,O,Q,A,Y,O,O,O,E,O,O,C,I,C,Q,S,E,C,C,C,E,G,C,C,C,E,C,C,G,C,C,C,E,C,C,I,E,A,Y,O,C,C,E,E,C,C,E,C,G,C,G,E,O,E,E,C,G,G,E,O,E,E,C,G,G,G,A,U,O,E,O,E,G,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,O,C,S,C,E,I,E,C,C,E,C,E,C,E,C,O,A,M,E,E,C,E,E,K,C,C,E,I,E,C,C,E,C,I,E,M,C,G,C,C,E,C,E,C,I,C,E,O,C,E,E,E,O,C,E,C,O,C,C,E,C,O,C,S,E,C,E,I,E,E,O,C,G,M,A,C,I,E,C,E,E,E,C,C,E,e,C,C,E,E,M,C,S,C,E,I,C,E,C,E,I,C,M,C,E,I,C,O,C,C,C,E,E,O,C,E,E,K,C,E,E,M,C,E,E,Q,C,S,C,C,C,E,C,C,E,C,C,S,C,C,C,E,E,O,C,C,E,C,E,A,E,O,c,C,E,O,C,I,W,O,C,C,E,A,C,G,C,C,E,C,E,I,I,E,E,E,E,M,C,I,E,C,C,E,E,G,E,C,I,E,E,E,A,C,U,O,S,A,a,O,O,O,O,C,E,Y,O,Q,O,G,E,O,W,O,C,E,C,E,C,M,C,S,C,C,C,C,C,C,C,ECuBA,IAAM,EAAS,CAvBA;A;A;A;A;A;A;A;A;A;AAUK,oBAAA,CAAC,CAEN;A;A;A;A;A;A;A;A;AASf,CAAC,CAE8B,CAE3B,EAA2B,EAAE,CAE7B,EAAkB,EAAE,CACpB,EAAgB,CAAC,EAAG,EAAE,CACtB,EAAQ,EAER,EAA6B,SAAS,cAAc,CAAC,WACrD,EAA4B,SAAS,cAAc,CAAC,SAExD,SAAS,EAAS,CAAa,EAC7B,EAAM,EACH,IAAI,GACJ,KAAK,CAAC,MACN,GAAG,CAAC,AAAC,GACG,EAAE,KAAK,CAAC,KAGnB,EAAe,EAAE,CACjB,EAAI,OAAO,CAAC,CAAC,EAAK,KAChB,EAAI,OAAO,CAAC,CAAC,EAAK,KACL,KAAP,GACF,CAAA,EAAM,CAAC,EAAG,EAAE,AAAA,EAEH,KAAP,GA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","sources":["<anon>","src/index.ts"],"sourcesContent":["// modules are defined as an array\n// [ module function, map of requires ]\n//\n// map of requires is short require name -> numeric require\n//\n// anything defined in a previous bundle is accessed via the\n// orig method which is the require for previous bundles\n\n(function (modules, entry, mainEntry, parcelRequireName, globalName) {\n  /* eslint-disable no-undef */\n  var globalObject =\n    typeof globalThis !== 'undefined'\n      ? globalThis\n      : typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n      ? window\n      : typeof global !== 'undefined'\n      ? global\n      : {};\n  /* eslint-enable no-undef */\n\n  // Save the require from previous bundle to this closure if any\n  var previousRequire =\n    typeof globalObject[parcelRequireName] === 'function' &&\n    globalObject[parcelRequireName];\n\n  var cache = previousRequire.cache || {};\n  // Do not use `require` to prevent Webpack from trying to bundle this call\n  var nodeRequire =\n    typeof module !== 'undefined' &&\n    typeof module.require === 'function' &&\n    module.require.bind(module);\n\n  function newRequire(name, jumped) {\n    if (!cache[name]) {\n      if (!modules[name]) {\n        // if we cannot find the module within our internal map or\n        // cache jump to the current global require ie. the last bundle\n        // that was added to the page.\n        var currentRequire =\n          typeof globalObject[parcelRequireName] === 'function' &&\n          globalObject[parcelRequireName];\n        if (!jumped && currentRequire) {\n          return currentRequire(name, true);\n        }\n\n        // If there are other bundles on this page the require from the\n        // previous one is saved to 'previousRequire'. Repeat this as\n        // many times as there are bundles until the module is found or\n        // we exhaust the require chain.\n        if (previousRequire) {\n          return previousRequire(name, true);\n        }\n\n        // Try the node require function if it exists.\n        if (nodeRequire && typeof name === 'string') {\n          return nodeRequire(name);\n        }\n\n        var err = new Error(\"Cannot find module '\" + name + \"'\");\n        err.code = 'MODULE_NOT_FOUND';\n        throw err;\n      }\n\n      localRequire.resolve = resolve;\n      localRequire.cache = {};\n\n      var module = (cache[name] = new newRequire.Module(name));\n\n      modules[name][0].call(\n        module.exports,\n        localRequire,\n        module,\n        module.exports,\n        globalObject\n      );\n    }\n\n    return cache[name].exports;\n\n    function localRequire(x) {\n      var res = localRequire.resolve(x);\n      return res === false ? {} : newRequire(res);\n    }\n\n    function resolve(x) {\n      var id = modules[name][1][x];\n      return id != null ? id : x;\n    }\n  }\n\n  function Module(moduleName) {\n    this.id = moduleName;\n    this.bundle = newRequire;\n    this.exports = {};\n  }\n\n  newRequire.isParcelRequire = true;\n  newRequire.Module = Module;\n  newRequire.modules = modules;\n  newRequire.cache = cache;\n  newRequire.parent = previousRequire;\n  newRequire.register = function (id, exports) {\n    modules[id] = [\n      function (require, module) {\n        module.exports = exports;\n      },\n      {},\n    ];\n  };\n\n  Object.defineProperty(newRequire, 'root', {\n    get: function () {\n      return globalObject[parcelRequireName];\n    },\n  });\n\n  globalObject[parcelRequireName] = newRequire;\n\n  for (var i = 0; i < entry.length; i++) {\n    newRequire(entry[i]);\n  }\n\n  if (mainEntry) {\n    // Expose entry point to Node, AMD or browser globals\n    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js\n    var mainExports = newRequire(mainEntry);\n\n    // CommonJS\n    if (typeof exports === 'object' && typeof module !== 'undefined') {\n      module.exports = mainExports;\n\n      // RequireJS\n    } else if (typeof define === 'function' && define.amd) {\n      define(function () {\n        return mainExports;\n      });\n\n      // <script>\n    } else if (globalName) {\n      this[globalName] = mainExports;\n    }\n  }\n})({\"lyLMh\":[function(require,module,exports,__globalThis) {\nconst level1 = `\n####################\n##    []    []  []##\n##            []  ##\n##  [][]    []  []##\n##    []@     []  ##\n##[]##    []      ##\n##[]    []    []  ##\n##  [][]  []  [][]##\n##        []      ##\n####################`;\nconst level2 = `\n########        \n###    #####    \n##         #    \n###  ###   #####\n#XX  XX# []@   #\n#      # [][]  #\n#XX    #       #\n################\n`;\nconst levels = [\n    level1,\n    level2\n];\nlet currentLevel = 1;\nlet winPositions = [];\nlet map = [];\nlet pos = [\n    0,\n    0\n];\nlet steps = 0;\nlet youWinElement = document.getElementById(\"you-win\");\nlet stepsElement = document.getElementById(\"steps\");\nfunction resetMap(input) {\n    map = input.trim().split(\"\\n\").map((x)=>{\n        return x.split(\"\");\n    });\n    winPositions = [];\n    map.forEach((row, x)=>{\n        row.forEach((col, y)=>{\n            if (col == \"@\") pos = [\n                x,\n                y\n            ];\n            if (col == \"X\") winPositions.push([\n                x,\n                y\n            ]);\n        });\n    });\n    steps = 0;\n    youWinElement.classList.remove(\"show\");\n    stepsElement.innerText = `steps: ${steps}`;\n}\nfunction findObject(pos, dir, visited) {\n    if (visited.has(JSON.stringify(pos))) return [];\n    visited.add(JSON.stringify(pos));\n    let ans = [];\n    let [x, y] = pos;\n    switch(map[x][y]){\n        case \"@\":\n            ans.push([\n                pos[0],\n                pos[1],\n                map[x][y]\n            ]);\n            findObject([\n                x + dir[0],\n                y + dir[1]\n            ], dir, visited).forEach((res)=>ans.push(res));\n            break;\n        case \"[\":\n            ans.push([\n                pos[0],\n                pos[1],\n                map[x][y]\n            ]);\n            if (JSON.stringify(dir) == \"[0,-1]\" || JSON.stringify(dir) == \"[0,1]\") findObject([\n                x + dir[0],\n                y + dir[1]\n            ], dir, visited).forEach((res)=>ans.push(res));\n            else {\n                findObject([\n                    x + dir[0],\n                    y + dir[1]\n                ], dir, visited).forEach((res)=>ans.push(res));\n                findObject([\n                    x,\n                    y + 1\n                ], dir, visited).forEach((res)=>ans.push(res));\n            }\n            break;\n        case \"]\":\n            ans.push([\n                pos[0],\n                pos[1],\n                map[x][y]\n            ]);\n            if (JSON.stringify(dir) == \"[0,-1]\" || JSON.stringify(dir) == \"[0,1]\") findObject([\n                x + dir[0],\n                y + dir[1]\n            ], dir, visited).forEach((res)=>ans.push(res));\n            else {\n                findObject([\n                    x + dir[0],\n                    y + dir[1]\n                ], dir, visited).forEach((res)=>ans.push(res));\n                findObject([\n                    x,\n                    y - 1\n                ], dir, visited).forEach((res)=>ans.push(res));\n            }\n            break;\n        case \" \":\n        case \"#\":\n            break;\n    }\n    return ans;\n}\nfunction checkMove(obj, dir) {\n    return obj.every((pos)=>{\n        return map[pos[0] + dir[0]][pos[1] + dir[1]] != \"#\";\n    });\n}\nfunction pushObject(obj, dir) {\n    // Push to new positions\n    obj.slice().reverse().forEach((pos)=>{\n        map[pos[0] + dir[0]][pos[1] + dir[1]] = pos[2];\n    });\n    // Cleanup old positions\n    let newPositions = new Set();\n    obj.forEach((pos)=>{\n        newPositions.add(JSON.stringify([\n            pos[0] + dir[0],\n            pos[1] + dir[1]\n        ]));\n    });\n    obj.filter((pos)=>!newPositions.has(JSON.stringify([\n            pos[0],\n            pos[1]\n        ]))).forEach((pos)=>{\n        map[pos[0]][pos[1]] = \" \";\n    });\n}\nfunction movePlayer(dir) {\n    let obj = findObject(pos, dir, new Set());\n    if (checkMove(obj, dir)) {\n        pushObject(obj, dir);\n        map[pos[0]][pos[1]] = \" \";\n        pos = [\n            pos[0] + dir[0],\n            pos[1] + dir[1]\n        ];\n        steps += 1;\n        stepsElement.innerText = `steps: ${steps}`;\n    }\n}\nlet el = document.getElementById(\"matrix\");\nfunction render() {\n    let filled = 0;\n    winPositions.forEach(([x, y])=>{\n        if (map[x][y] == \" \") map[x][y] = \"X\";\n        else if (map[x][y] != \"X\") filled += 1;\n    });\n    if (filled == winPositions.length) {\n        youWinElement.innerText = `You win in ${steps} steps`;\n        youWinElement.classList.add(\"show\");\n    }\n    el.innerHTML = map.map((row)=>row.map((c)=>{\n            switch(c){\n                case \" \":\n                    return \"&nbsp\";\n                case \"#\":\n                    return '<span class=\"text-50\">#</span>';\n                case \"@\":\n                    return '<span class=\"text-player\">@</span>';\n                case \"X\":\n                    return '<span class=\"text-target\">X</span>';\n                default:\n                    return c;\n            }\n        }).join(\"\")).join(\"<br/>\");\n}\nfunction dirFromEvent(e) {\n    switch(e.key){\n        case \"ArrowUp\":\n            return [\n                -1,\n                0\n            ];\n        case \"ArrowDown\":\n            return [\n                1,\n                0\n            ];\n        case \"ArrowLeft\":\n            return [\n                0,\n                -1\n            ];\n        case \"ArrowRight\":\n            return [\n                0,\n                1\n            ];\n    }\n    throw \"unknown key event\";\n}\nwindow.addEventListener(\"keydown\", (e)=>{\n    if (![\n        \"ArrowUp\",\n        \"ArrowDown\",\n        \"ArrowRight\",\n        \"ArrowLeft\",\n        \"r\"\n    ].includes(e.key)) return e;\n    if (e.key == \"r\") {\n        resetMap(levels[currentLevel]);\n        render();\n        return;\n    }\n    e.preventDefault();\n    movePlayer(dirFromEvent(e));\n    render();\n});\nlet upButton = document.getElementById(\"up\");\nupButton.addEventListener(\"click\", ()=>{\n    movePlayer([\n        -1,\n        0\n    ]);\n    render();\n});\nlet downButton = document.getElementById(\"down\");\ndownButton.addEventListener(\"click\", ()=>{\n    movePlayer([\n        1,\n        0\n    ]);\n    render();\n});\nlet leftButton = document.getElementById(\"left\");\nleftButton.addEventListener(\"click\", ()=>{\n    movePlayer([\n        0,\n        -1\n    ]);\n    render();\n});\nlet rightButton = document.getElementById(\"right\");\nrightButton.addEventListener(\"click\", ()=>{\n    movePlayer([\n        0,\n        1\n    ]);\n    render();\n});\nlet resetButton = document.getElementById(\"reset\");\nresetButton.addEventListener(\"click\", ()=>{\n    resetMap(levels[currentLevel]);\n    render();\n});\nresetMap(levels[currentLevel]);\nrender();\n\n},{}]},[\"lyLMh\"], \"lyLMh\", \"parcelRequire94c2\")\n\n//# sourceMappingURL=index.24fddfa5.js.map\n","const level1 = `\n####################\n##    []    []  []##\n##            []  ##\n##  [][]    []  []##\n##    []@     []  ##\n##[]##    []      ##\n##[]    []    []  ##\n##  [][]  []  [][]##\n##        []      ##\n####################`;\n\nconst level2 = `\n########        \n###    #####    \n##         #    \n###  ###   #####\n#XX  XX# []@   #\n#      # [][]  #\n#XX    #       #\n################\n`;\n\nconst levels = [level1, level2];\nlet currentLevel = 1;\nlet winPositions: number[][] = [];\n\nlet map: string[][] = [];\nlet pos: number[] = [0, 0];\nlet steps = 0;\n\nlet youWinElement: HTMLElement = document.getElementById(\"you-win\")!!;\nlet stepsElement: HTMLElement = document.getElementById(\"steps\")!!;\n\nfunction resetMap(input: string) {\n  map = input\n    .trim()\n    .split(\"\\n\")\n    .map((x: string) => {\n      return x.split(\"\");\n    });\n\n  winPositions = [];\n  map.forEach((row, x) => {\n    row.forEach((col, y) => {\n      if (col == \"@\") {\n        pos = [x, y];\n      }\n      if (col == \"X\") {\n        winPositions.push([x, y]);\n      }\n    });\n  });\n\n  steps = 0;\n  youWinElement.classList.remove(\"show\");\n  stepsElement.innerText = `steps: ${steps}`;\n}\n\nfunction findObject(\n  pos: number[],\n  dir: number[],\n  visited: Set<string>,\n): any[][] {\n  if (visited.has(JSON.stringify(pos))) {\n    return [];\n  }\n  visited.add(JSON.stringify(pos));\n\n  let ans: any[][] = [];\n  let [x, y] = pos;\n  switch (map[x][y]) {\n    case \"@\":\n      ans.push([pos[0], pos[1], map[x][y]]);\n      findObject([x + dir[0], y + dir[1]], dir, visited).forEach((res) =>\n        ans.push(res),\n      );\n      break;\n\n    case \"[\":\n      ans.push([pos[0], pos[1], map[x][y]]);\n      if (JSON.stringify(dir) == \"[0,-1]\" || JSON.stringify(dir) == \"[0,1]\") {\n        findObject([x + dir[0], y + dir[1]], dir, visited).forEach((res) =>\n          ans.push(res),\n        );\n      } else {\n        findObject([x + dir[0], y + dir[1]], dir, visited).forEach((res) =>\n          ans.push(res),\n        );\n        findObject([x, y + 1], dir, visited).forEach((res) => ans.push(res));\n      }\n      break;\n\n    case \"]\":\n      ans.push([pos[0], pos[1], map[x][y]]);\n      if (JSON.stringify(dir) == \"[0,-1]\" || JSON.stringify(dir) == \"[0,1]\") {\n        findObject([x + dir[0], y + dir[1]], dir, visited).forEach((res) =>\n          ans.push(res),\n        );\n      } else {\n        findObject([x + dir[0], y + dir[1]], dir, visited).forEach((res) =>\n          ans.push(res),\n        );\n        findObject([x, y - 1], dir, visited).forEach((res) => ans.push(res));\n      }\n      break;\n\n    case \" \":\n    case \"#\":\n      break;\n  }\n  return ans;\n}\n\nfunction checkMove(obj: any[][], dir: number[]): boolean {\n  return obj.every((pos) => {\n    return map[pos[0] + dir[0]][pos[1] + dir[1]] != \"#\";\n  });\n}\n\nfunction pushObject(obj: any[][], dir: number[]) {\n  // Push to new positions\n  obj\n    .slice()\n    .reverse()\n    .forEach((pos) => {\n      map[pos[0] + dir[0]][pos[1] + dir[1]] = pos[2];\n    });\n\n  // Cleanup old positions\n  let newPositions = new Set();\n  obj.forEach((pos) => {\n    newPositions.add(JSON.stringify([pos[0] + dir[0], pos[1] + dir[1]]));\n  });\n  obj\n    .filter((pos) => !newPositions.has(JSON.stringify([pos[0], pos[1]])))\n    .forEach((pos) => {\n      map[pos[0]][pos[1]] = \" \";\n    });\n}\n\nfunction movePlayer(dir: number[]) {\n  let obj = findObject(pos, dir, new Set());\n  if (checkMove(obj, dir)) {\n    pushObject(obj, dir);\n    map[pos[0]][pos[1]] = \" \";\n    pos = [pos[0] + dir[0], pos[1] + dir[1]];\n    steps += 1;\n    stepsElement.innerText = `steps: ${steps}`;\n  }\n}\n\nlet el: HTMLElement = document.getElementById(\"matrix\")!!;\nfunction render(): void {\n  let filled = 0;\n\n  winPositions.forEach(([x, y]) => {\n    if (map[x][y] == \" \") {\n      map[x][y] = \"X\";\n    } else if (map[x][y] != \"X\") {\n      filled += 1;\n    }\n  });\n\n  if (filled == winPositions.length) {\n    youWinElement.innerText = `You win in ${steps} steps`;\n    youWinElement.classList.add(\"show\");\n  }\n\n  el.innerHTML = map\n    .map((row) =>\n      row\n        .map((c) => {\n          switch (c) {\n            case \" \":\n              return \"&nbsp\";\n            case \"#\":\n              return '<span class=\"text-50\">#</span>';\n            case \"@\":\n              return '<span class=\"text-player\">@</span>';\n            case \"X\":\n              return '<span class=\"text-target\">X</span>';\n            default:\n              return c;\n          }\n        })\n        .join(\"\"),\n    )\n    .join(\"<br/>\");\n}\n\nfunction dirFromEvent(e: KeyboardEvent): number[] {\n  switch (e.key) {\n    case \"ArrowUp\":\n      return [-1, 0];\n    case \"ArrowDown\":\n      return [1, 0];\n    case \"ArrowLeft\":\n      return [0, -1];\n    case \"ArrowRight\":\n      return [0, 1];\n  }\n  throw \"unknown key event\";\n}\n\nwindow.addEventListener(\"keydown\", (e) => {\n  if (\n    ![\"ArrowUp\", \"ArrowDown\", \"ArrowRight\", \"ArrowLeft\", \"r\"].includes(e.key)\n  ) {\n    return e;\n  }\n\n  if (e.key == \"r\") {\n    resetMap(levels[currentLevel]);\n    render();\n    return;\n  }\n\n  e.preventDefault();\n  movePlayer(dirFromEvent(e));\n  render();\n});\n\nlet upButton = document.getElementById(\"up\")!!;\nupButton.addEventListener(\"click\", () => {\n  movePlayer([-1, 0]);\n  render();\n});\n\nlet downButton = document.getElementById(\"down\")!!;\ndownButton.addEventListener(\"click\", () => {\n  movePlayer([1, 0]);\n  render();\n});\n\nlet leftButton = document.getElementById(\"left\")!!;\nleftButton.addEventListener(\"click\", () => {\n  movePlayer([0, -1]);\n  render();\n});\n\nlet rightButton = document.getElementById(\"right\")!!;\nrightButton.addEventListener(\"click\", () => {\n  movePlayer([0, 1]);\n  render();\n});\n\nlet resetButton = document.getElementById(\"reset\")!!;\nresetButton.addEventListener(\"click\", () => {\n  resetMap(levels[currentLevel]);\n  render();\n});\n\nresetMap(levels[currentLevel]);\nrender();\n"],"names":["modules","entry","mainEntry","parcelRequireName","globalName","globalObject","globalThis","self","window","global","previousRequire","cache","nodeRequire","module","require","bind","newRequire","name","jumped","currentRequire","err","Error","code","localRequire","resolve","x","id","Module","call","exports","res","isParcelRequire","moduleName","bundle","parent","register","Object","defineProperty","get","i","length","mainExports","define","amd","__globalThis","levels","winPositions","map","pos","steps","youWinElement","document","getElementById","stepsElement","resetMap","input","trim","split","forEach","row","col","y","push","classList","remove","innerText","movePlayer","dir","obj","findObject","visited","has","JSON","stringify","add","ans","Set","every","pushObject","slice","reverse","newPositions","filter","el","render","filled","innerHTML","c","join","addEventListener","e","includes","key","preventDefault","dirFromEvent","upButton","downButton","leftButton","rightButton","resetButton"],"version":3,"file":"index.24fddfa5.js.map"}